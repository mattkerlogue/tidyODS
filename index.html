<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Import cells from ODS files. Identify a cell's postion, value types
    and formulas, and provide methods to &quot;rectify&quot; cells back to a 2-dimensional
    data.frame.">
<title>Read cells from ODS files • tidyods</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Read cells from ODS files">
<meta property="og:description" content="Import cells from ODS files. Identify a cell's postion, value types
    and formulas, and provide methods to &quot;rectify&quot; cells back to a 2-dimensional
    data.frame.">
<meta property="og:image" content="https://mattkerlogue.github.io/tidyODS/reference/figures/tidyods_hex_banner.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@mattkerlogue">
<meta name="twitter:site" content="@mattkerlogue">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">tidyods</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mattkerlogue/tidyods/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="tidyods-">tidyods <img src="reference/figures/tidyods_hex.png" align="right" alt="tidyods package logo" width="120"><a class="anchor" aria-label="anchor" href="#tidyods-"></a>
</h1></div>
<!-- badges: start -->
<p><a href="https://github.com/mattkerlogue/tidyods" class="external-link">tidyods</a> is an R package to import cells from an OpenDocument Spreadsheet (ODS) file, and provide information about the cell’s postion, value types and formulas, and provide methods to “rectify” cells back to a 2-dimensional data.frame (specifically as a tidyverse tibble).</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of <a href="https://github.com/mattkerlogue/tidyods" class="external-link">tidyods</a> like so:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"mattkerlogue/tidyods"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>The <a href="https://github.com/mattkerlogue/tidyods" class="external-link">tidyods</a> package exports the following functions for users:</p>
<ul>
<li>
<code>read_ods_cells(path, sheet, quick = FALSE)</code>: extract the cells from a sheet in an ODS file</li>
<li>
<code>read_ods_sheet(path, sheet, rectify = "simple", base_values = TRUE, quick = FALSE)</code>: extract cells from an ODS sheet and return as a rectangular dataset, like a spreadsheet</li>
<li>
<code>ods_sheets(path)</code>: list the sheets in an ODS fie</li>
<li>
<code>simple_rectify(path)</code>: “rectify” a set of cells into a rectangular dataset, like a spreadsheet</li>
</ul>
<p>The package includes an example ODS with two sheets: <code>penguins</code> and <code>types</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mattkerlogue/tidyods" class="external-link">tidyods</a></span><span class="op">)</span>

<span class="va">example_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"basic_example.ods"</span>, package <span class="op">=</span> <span class="st">"tidyods"</span><span class="op">)</span>

<span class="fu"><a href="reference/ods_sheets.html">ods_sheets</a></span><span class="op">(</span><span class="va">example_file</span><span class="op">)</span>
<span class="co">#&gt; Unzipping ODS file</span>
<span class="co">#&gt; Reading XML file</span>
<span class="co">#&gt; [1] "penguins" "types"</span></code></pre></div>
<p>The <code>penguins</code> sheet is a simple 6 rows by 4 columns sheet that stores the output of the following code:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">palmerpenguins</span><span class="fu">::</span><span class="va"><a href="https://allisonhorst.github.io/palmerpenguins/reference/penguins.html" class="external-link">penguins</a></span> |&gt;
  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html" class="external-link">drop_na</a></span><span class="op">(</span><span class="op">)</span> |&gt;
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">species</span>, female <span class="op">=</span> <span class="va">sex</span> <span class="op">==</span> <span class="st">"female"</span><span class="op">)</span> |&gt;
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>
    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">bill_length_mm</span>, <span class="va">body_mass_g</span><span class="op">)</span>, <span class="va">mean</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
    .groups <span class="op">=</span> <span class="st">"drop"</span>
  <span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 × 4</span>
<span class="co">#&gt;   species   female bill_length_mm body_mass_g</span>
<span class="co">#&gt;   &lt;fct&gt;     &lt;lgl&gt;           &lt;dbl&gt;       &lt;dbl&gt;</span>
<span class="co">#&gt; 1 Adelie    FALSE            40.4       4043.</span>
<span class="co">#&gt; 2 Adelie    TRUE             37.3       3369.</span>
<span class="co">#&gt; 3 Chinstrap FALSE            51.1       3939.</span>
<span class="co">#&gt; 4 Chinstrap TRUE             46.6       3527.</span>
<span class="co">#&gt; 5 Gentoo    FALSE            49.5       5485.</span>
<span class="co">#&gt; 6 Gentoo    TRUE             45.6       4680.</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">penguin_sheet</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/read_ods_sheet.html">read_ods_sheet</a></span><span class="op">(</span><span class="va">example_file</span>, <span class="st">"penguins"</span>, quick <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; Unzipping ODS file</span>
<span class="co">#&gt; Reading XML file</span>

<span class="va">penguin_sheet</span>
<span class="co">#&gt; # A tibble: 7 × 4</span>
<span class="co">#&gt;   X1        X2     X3             X4         </span>
<span class="co">#&gt;   &lt;chr&gt;     &lt;chr&gt;  &lt;chr&gt;          &lt;chr&gt;      </span>
<span class="co">#&gt; 1 species   female bill_length_mm body_mass_g</span>
<span class="co">#&gt; 2 Adelie    FALSE  40.4           4043       </span>
<span class="co">#&gt; 3 Adelie    TRUE   37.3           3369       </span>
<span class="co">#&gt; 4 Chinstrap FALSE  51.1           3939       </span>
<span class="co">#&gt; 5 Chinstrap TRUE   46.6           3527       </span>
<span class="co">#&gt; 6 Gentoo    FALSE  49.5           5485       </span>
<span class="co">#&gt; 7 Gentoo    TRUE   45.6           4680</span></code></pre></div>
<p>While the <code>types</code> sheet shows examples of the different ODS data types:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">types_cells</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/read_ods_cells.html">read_ods_cells</a></span><span class="op">(</span><span class="va">example_file</span>, <span class="st">"types"</span><span class="op">)</span>
<span class="co">#&gt; Unzipping ODS file</span>
<span class="co">#&gt; Reading XML file</span>

<span class="va">types_cells</span> |&gt; 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">row</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> |&gt;
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">col</span><span class="op">)</span> |&gt;
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Rows: 110</span>
<span class="co">#&gt; Columns: 13</span>
<span class="co">#&gt; Groups: col [10]</span>
<span class="co">#&gt; $ sheet           &lt;chr&gt; "types", "types", "types", "types", "types", "types", …</span>
<span class="co">#&gt; $ row             &lt;int&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, …</span>
<span class="co">#&gt; $ col             &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 1, 2, 3, 4, 5, 6, 7, 8,…</span>
<span class="co">#&gt; $ cell_type       &lt;chr&gt; "cell", "cell", "cell", "cell", "cell", "cell", "cell"…</span>
<span class="co">#&gt; $ value_type      &lt;chr&gt; "string", "boolean", "currency", "date", "time", "date…</span>
<span class="co">#&gt; $ cell_content    &lt;chr&gt; "Cell", "TRUE", "£1.20", "15/06/22", "13:24:56", "15/0…</span>
<span class="co">#&gt; $ base_value      &lt;chr&gt; "Cell", "true", "1.2", "2022-06-15", "PT13H24M56S", "2…</span>
<span class="co">#&gt; $ numeric_value   &lt;dbl&gt; NA, NA, 1.2000, NA, NA, NA, 12034.5679, 0.5467, 6579.2…</span>
<span class="co">#&gt; $ logical_value   &lt;lgl&gt; NA, TRUE, NA, NA, NA, NA, NA, NA, NA, NA, NA, FALSE, N…</span>
<span class="co">#&gt; $ currency_symbol &lt;chr&gt; NA, NA, "GBP", NA, NA, NA, NA, NA, NA, NA, NA, NA, "GB…</span>
<span class="co">#&gt; $ has_formula     &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE…</span>
<span class="co">#&gt; $ cell_formula    &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, "of:=[.G2]*[.H2]", "of…</span>
<span class="co">#&gt; $ error           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…</span>

<span class="va">types_cells</span> |&gt;
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">row</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> |&gt;
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">col</span><span class="op">)</span> |&gt;
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> |&gt;
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">cell_type</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 20 × 12</span>
<span class="co">#&gt; # Groups:   col [10]</span>
<span class="co">#&gt;    sheet   row   col value_type cell_content        base_value     numeric_value</span>
<span class="co">#&gt;    &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;               &lt;chr&gt;                  &lt;dbl&gt;</span>
<span class="co">#&gt;  1 types     2     1 string     Cell                "Cell"                NA    </span>
<span class="co">#&gt;  2 types     3     1 string     Cell with comment   "Cell with co…        NA    </span>
<span class="co">#&gt;  3 types     2     2 boolean    TRUE                "true"                NA    </span>
<span class="co">#&gt;  4 types     3     2 boolean    FALSE               "false"               NA    </span>
<span class="co">#&gt;  5 types     2     3 currency   £1.20               "1.2"                  1.2  </span>
<span class="co">#&gt;  6 types     3     3 currency   £1.20               "1.2"                  1.2  </span>
<span class="co">#&gt;  7 types     2     4 date       15/06/22            "2022-06-15"          NA    </span>
<span class="co">#&gt;  8 types     3     4 date       06/15/22            "2022-06-15"          NA    </span>
<span class="co">#&gt;  9 types     2     5 time       13:24:56            "PT13H24M56S"         NA    </span>
<span class="co">#&gt; 10 types     3     5 time       13:24               "PT13H24M56S"         NA    </span>
<span class="co">#&gt; 11 types     2     6 date       15/06/2022 13:24:56 "2022-06-15T1…        NA    </span>
<span class="co">#&gt; 12 types     3     6 date       15/06/22 13:24      "2022-06-15T1…        NA    </span>
<span class="co">#&gt; 13 types     2     7 float      12035               "12034.56789"      12035.   </span>
<span class="co">#&gt; 14 types     3     7 float      12034.57            "12034.56789"      12035.   </span>
<span class="co">#&gt; 15 types     2     8 float      0.5467              "0.5467"               0.547</span>
<span class="co">#&gt; 16 types     3     8 percentage 55%                 "0.5467"               0.547</span>
<span class="co">#&gt; 17 types     2     9 float      6579.3              "6579.2982654…      6579.   </span>
<span class="co">#&gt; 18 types     3     9 float      6579.3              "6579.2982654…      6579.   </span>
<span class="co">#&gt; 19 types     2    10 string     #N/A                ""                    NA    </span>
<span class="co">#&gt; 20 types     3    10 string     #DIV/0!             ""                    NA    </span>
<span class="co">#&gt; # … with 5 more variables: logical_value &lt;lgl&gt;, currency_symbol &lt;chr&gt;,</span>
<span class="co">#&gt; #   has_formula &lt;lgl&gt;, cell_formula &lt;chr&gt;, error &lt;dbl&gt;</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="performance">Performance<a class="anchor" aria-label="anchor" href="#performance"></a>
</h2>
<p>An ODS file is a zipped collection of XML files and associated files. <a href="https://github.com/mattkerlogue/tidyods" class="external-link">tidyods</a>, like the <code>{readODS}</code> package, uses the <a href="https://xml2.r-lib.org" class="external-link">xml2</a> package to process this file. There are three likely sources of performance issues: downloading of remote files, unzipping the ODS file, processing rows.</p>
<p>With default settings, performance of <a href="https://github.com/mattkerlogue/tidyods" class="external-link">tidyods</a> functions is marginally slower for small files than <code>{readODS}</code>, but this is unlikely to be noticeable to users. When working with larger files performnace is comparable.</p>
<p>Performance can be improved by setting <code>quick = TRUE</code> in <code><a href="reference/read_ods_cells.html">read_ods_cells()</a></code> and <code><a href="reference/read_ods_sheet.html">read_ods_sheet()</a></code>, this will extract only a simple text representation of the cell, i.e. it will not provide information on cell or value types, formulas or the underlying base value for numbers, dates or times.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">types_cells_quick</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/read_ods_cells.html">read_ods_cells</a></span><span class="op">(</span><span class="va">example_file</span>, <span class="st">"types"</span>, quick <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; Unzipping ODS file</span>
<span class="co">#&gt; Reading XML file</span>

<span class="va">types_cells_quick</span> |&gt;
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">row</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> |&gt;
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">col</span><span class="op">)</span> |&gt;
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Rows: 110</span>
<span class="co">#&gt; Columns: 4</span>
<span class="co">#&gt; Groups: col [10]</span>
<span class="co">#&gt; $ sheet        &lt;chr&gt; "types", "types", "types", "types", "types", "types", "ty…</span>
<span class="co">#&gt; $ row          &lt;int&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, …</span>
<span class="co">#&gt; $ col          &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 1, 2, 3, 4, 5, 6, 7, 8, 9,…</span>
<span class="co">#&gt; $ cell_content &lt;chr&gt; "Cell", "TRUE", "£1.20", "15/06/22", "13:24:56", "15/06/2…</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">test_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"basic_example.ods"</span>, package <span class="op">=</span> <span class="st">"tidyods"</span><span class="op">)</span>

<span class="fu">microbenchmark</span><span class="fu">::</span><span class="fu">microbenchmark</span><span class="op">(</span>
  tidy_quick <span class="op">=</span> <span class="fu"><a href="reference/read_ods_cells.html">read_ods_cells</a></span><span class="op">(</span><span class="va">test_file</span>, <span class="fl">1</span>, quick <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
  tidy_slow <span class="op">=</span> <span class="fu"><a href="reference/read_ods_cells.html">read_ods_cells</a></span><span class="op">(</span><span class="va">test_file</span>, <span class="fl">1</span><span class="op">)</span>,
  tidy_sheet_quick <span class="op">=</span> <span class="fu"><a href="reference/read_ods_sheet.html">read_ods_sheet</a></span><span class="op">(</span><span class="va">test_file</span>, <span class="fl">1</span>, quick <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
  tidy_sheet_slow <span class="op">=</span> <span class="fu"><a href="reference/read_ods_sheet.html">read_ods_sheet</a></span><span class="op">(</span><span class="va">test_file</span>, <span class="fl">1</span><span class="op">)</span>,
  read_ods <span class="op">=</span> <span class="fu">readODS</span><span class="fu">::</span><span class="fu">read_ods</span><span class="op">(</span><span class="va">test_file</span>, <span class="fl">1</span><span class="op">)</span>,
  times <span class="op">=</span> <span class="fl">100</span>
<span class="op">)</span>

<span class="co">#&gt; Unit: milliseconds</span>
<span class="co">#&gt;              expr       min       lq     mean   median       uq       max neval</span>
<span class="co">#&gt;        tidy_quick 24.280200 25.44304 27.45693 26.25878 29.51594  33.89195   100</span>
<span class="co">#&gt;         tidy_slow 34.481574 36.26819 38.81044 37.82586 41.17425  47.92445   100</span>
<span class="co">#&gt;  tidy_sheet_quick 31.678445 33.50053 36.11012 34.95258 38.76044  44.62018   100</span>
<span class="co">#&gt;   tidy_sheet_slow 41.229846 42.25362 47.12949 46.38392 47.86963 125.16058   100</span>
<span class="co">#&gt;          read_ods  9.995062 10.46072 12.07059 10.58868 10.95301 118.04728   100</span></code></pre></div>
<p>To test real-world performance we will use an ODS file published by the UK Government on the <a href="https://www.gov.uk/government/statistics/number-of-civil-servants-by-postcode-department-responsibility-level-and-leaving-cause-2021" class="external-link">number of civil servants by postcode</a> (5,544 rows by 11 columns). Analysis of read times indicates similar performance to that achieved by <code>{readODS}</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">postcodes_file</span> <span class="op">&lt;-</span> <span class="st">"~/Downloads/Civil-servants-by-postcode-department-
  responsibility-level-and-leaving-cause-2021.ods"</span>

<span class="fu">microbenchmark</span><span class="fu">::</span><span class="fu">microbenchmark</span><span class="op">(</span>
  tidy_quick <span class="op">=</span> <span class="fu"><a href="reference/read_ods_cells.html">read_ods_cells</a></span><span class="op">(</span><span class="va">postcodes_file</span>, <span class="fl">2</span>, quick <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
  tidy_slow <span class="op">=</span> <span class="fu"><a href="reference/read_ods_cells.html">read_ods_cells</a></span><span class="op">(</span><span class="va">postcodes_file</span>, <span class="fl">2</span><span class="op">)</span>,
  tidy_sheet_quick <span class="op">=</span> <span class="fu"><a href="reference/read_ods_sheet.html">read_ods_sheet</a></span><span class="op">(</span><span class="va">postcodes_file</span>, <span class="fl">2</span>, quick <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
  tidy_sheet_slow <span class="op">=</span> <span class="fu"><a href="reference/read_ods_sheet.html">read_ods_sheet</a></span><span class="op">(</span><span class="va">postcodes_file</span>, <span class="fl">2</span><span class="op">)</span>,
  read_ods <span class="op">=</span> <span class="fu">readODS</span><span class="fu">::</span><span class="fu">read_ods</span><span class="op">(</span><span class="va">postcodes_file</span>, <span class="fl">2</span><span class="op">)</span>,
  times <span class="op">=</span> <span class="fl">10</span>
<span class="op">)</span>

<span class="co">#&gt; Unit: seconds</span>
<span class="co">#&gt;              expr      min       lq     mean   median       uq      max neval</span>
<span class="co">#&gt;        tidy_quick 5.696553 5.706185 5.849200 5.808597 5.990277 6.058689    10</span>
<span class="co">#&gt;         tidy_slow 6.909598 7.037668 7.124450 7.146029 7.185813 7.287308    10</span>
<span class="co">#&gt;  tidy_sheet_quick 5.758918 5.824600 5.951630 5.926395 6.084767 6.182411    10</span>
<span class="co">#&gt;   tidy_sheet_slow 6.963679 7.049813 7.158550 7.091867 7.176565 7.626200    10</span>
<span class="co">#&gt;          read_ods 4.774232 4.893009 5.025191 5.065590 5.108057 5.236603    10</span></code></pre></div>
<p>Due to the reliance on <a href="https://xml2.r-lib.org/" class="external-link">xml2</a> very large files will perform poorly or run into memory limitations. This is being investigated as part of the package development.</p>
<p>Performance issues are tracked and discussed in <a href="https://github.com/mattkerlogue/tidyods/issues/3" class="external-link">issue #3</a> in the package’s GitHub repository.</p>
</div>
<div class="section level2">
<h2 id="related-projects">Related projects<a class="anchor" aria-label="anchor" href="#related-projects"></a>
</h2>
<p>The <code>{tidyODS}</code> package is heavily inspired by two existing packages:</p>
<ul>
<li>The <a href="https://github.com/chainsawriot/readODS" class="external-link"><code>{readODS}</code></a> package provides functionality to read and write ODS files with R, with the resulting data.frame reflecting the way the data is viewed in a spreadsheet editor application (i.e a two-dimension table structure).</li>
<li>The <a href="https://nacnudus.github.io/tidyxl/" class="external-link"><code>{tidyxl}</code></a> package reads cells from Excel files and provides a data.frame where each cell is its own row and columns provide information about the cell’s location, value and value type, formula and formatting.</li>
<li>The <a href="https://nacnudus.github.io/unpivotr/" class="external-link"><code>{unpivotr}</code></a> package works with datasets of cells (such as those created by tidyxl).</li>
</ul>
</div>
<div class="section level2">
<h2 id="philosophy">Philosophy<a class="anchor" aria-label="anchor" href="#philosophy"></a>
</h2>
<p>The <code>{readODS}</code> package is the only package on CRAN that handles the reading of ODS files, whereas there are more than 20 packages (as at 12 June 2022) on CRAN that work with Excel files (of which <a href="https://github.com/nacnudus/tidyxl" class="external-link">tidyxl</a> is one). In some respects this is due to the wider usage of Excel files by businesses, governments, academia and other organisations to publish and share data. Various governments and international organisations are starting to mandate the use of OpenDocument Format files for publishing of their information.</p>
<p>The initial purpose of <a href="https://github.com/mattkerlogue/tidyods" class="external-link">tidyods</a> was to provide a second package to the R ecosystem for reading ODS files, in part prompted when encountering an error with <code>{readODS}</code> and discovering no alternative pacakge was available. For example if you run into an error when using the <a href="https://readxl.tidyverse.org" class="external-link">readxl</a> package you could use easily try the<a href="https://ycphs.github.io/openxlsx/index.html" class="external-link">openxlsx</a> or <a href="https://github.com/colearendt/xlsx" class="external-link">xlsx</a> instead.</p>
<p>The conceptual code development lead to the creation of an output dataset similar to that produced by the <a href="https://github.com/nacnudus/tidyxl" class="external-link">tidyxl</a> package.</p>
<p>Thus, <a href="https://github.com/mattkerlogue/tidyods" class="external-link">tidyods</a> extracts cells from an ODS document in the same manner as <a href="https://github.com/nacnudus/tidyxl" class="external-link">tidyxl</a>, but includes functions to “rectify” the cells so as to also provide an output similar to that of <code>{readODS}</code> (and many of those that read Excel files). This is similar to the <a href="https://nacnudus.github.io/unpivotr/reference/rectify.html" class="external-link">rectify</a> function in the <a href="https://github.com/nacnudus/unpivotr" class="external-link">unpivotr</a> package.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/mattkerlogue/tidyods/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/mattkerlogue/tidyods/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing tidyods</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Matt Kerlogue <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://www.repostatus.org/#concept" class="external-link"><img src="https://www.repostatus.org/badges/latest/concept.svg" alt="Project Status: Concept – Minimal or no implementation has been done yet, or the repository is only intended to be a limited example, demo, or proof-of-concept."></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Matt Kerlogue.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.4.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>

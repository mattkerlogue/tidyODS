<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Import cells from ODS files. Identify a cell's postion, value types
    and formulas, and provide methods to &quot;rectify&quot; cells back to a 2-dimensional
    data.frame.">
<title>Read cells from ODS files • tidyods</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Read cells from ODS files">
<meta property="og:description" content="Import cells from ODS files. Identify a cell's postion, value types
    and formulas, and provide methods to &quot;rectify&quot; cells back to a 2-dimensional
    data.frame.">
<meta property="og:image" content="https://mattkerlogue.github.io/tidyODS/reference/figures/tidyods_hex_banner.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@mattkerlogue">
<meta name="twitter:site" content="@mattkerlogue">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">tidyods</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mattkerlogue/tidyods/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="tidyods-">tidyods <img src="reference/figures/tidyods_hex.png" align="right" alt="tidyods package logo" width="120"><a class="anchor" aria-label="anchor" href="#tidyods-"></a>
</h1></div>
<!-- badges: start -->

<p><a href="https://github.com/mattkerlogue/tidyods" class="external-link">tidyods</a> imports cells from an OpenDocument Spreadsheet (ODS) file, and provides not just the cell’s value but also information about the cell’s position, value types and formulas in a tidy format to allow further programmatic analysis, investigation and manipulation. It also provides methods to “rectify” cells back to a 2-dimensional data.frame.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of <a href="https://github.com/mattkerlogue/tidyods" class="external-link">tidyods</a> like so:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"mattkerlogue/tidyods"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>You can read in cells via the <code><a href="reference/read_ods_cells.html">read_ods_cells()</a></code> function. There is a helper function <code><a href="reference/ods_sheets.html">ods_sheets()</a></code> that can list the sheets in an ODS file.</p>
<p>The package includes an example ODS with two sheets: <code>penguins</code> and <code>types</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mattkerlogue/tidyods" class="external-link">tidyods</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">example_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"basic_example.ods"</span>, package <span class="op">=</span> <span class="st">"tidyods"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/ods_sheets.html">ods_sheets</a></span><span class="op">(</span><span class="va">example_file</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "penguins" "types"</span></span>
<span></span>
<span><span class="fu"><a href="reference/read_ods_cells.html">read_ods_cells</a></span><span class="op">(</span><span class="va">example_file</span>, sheet <span class="op">=</span> <span class="st">"penguins"</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 28 × 25</span></span>
<span><span class="co">#&gt;    sheet      row   col cell_type is_empty value_type cell_content   base_value </span></span>
<span><span class="co">#&gt;    &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;     &lt;lgl&gt;    &lt;chr&gt;      &lt;chr&gt;          &lt;chr&gt;      </span></span>
<span><span class="co">#&gt;  1 penguins     1     1 cell      FALSE    string     species        species    </span></span>
<span><span class="co">#&gt;  2 penguins     1     2 cell      FALSE    string     female         female     </span></span>
<span><span class="co">#&gt;  3 penguins     1     3 cell      FALSE    string     bill_length_mm bill_lengt…</span></span>
<span><span class="co">#&gt;  4 penguins     1     4 cell      FALSE    string     body_mass_g    body_mass_g</span></span>
<span><span class="co">#&gt;  5 penguins     2     1 cell      FALSE    string     Adelie         Adelie     </span></span>
<span><span class="co">#&gt;  6 penguins     2     2 cell      FALSE    boolean    FALSE          false      </span></span>
<span><span class="co">#&gt;  7 penguins     2     3 cell      FALSE    float      40.4           40.3904109…</span></span>
<span><span class="co">#&gt;  8 penguins     2     4 cell      FALSE    float      4043           4043.49315…</span></span>
<span><span class="co">#&gt;  9 penguins     3     1 cell      FALSE    string     Adelie         Adelie     </span></span>
<span><span class="co">#&gt; 10 penguins     3     2 cell      FALSE    boolean    TRUE           true       </span></span>
<span><span class="co">#&gt; # ℹ 18 more rows</span></span>
<span><span class="co">#&gt; # ℹ 17 more variables: numeric_value &lt;dbl&gt;, currency_symbol &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   boolean_value &lt;lgl&gt;, date_value &lt;chr&gt;, time_value &lt;chr&gt;, has_formula &lt;lgl&gt;,</span></span>
<span><span class="co">#&gt; #   formula &lt;chr&gt;, has_error &lt;lgl&gt;, error_type &lt;dbl&gt;, has_annotation &lt;lgl&gt;,</span></span>
<span><span class="co">#&gt; #   annotation &lt;chr&gt;, is_merged &lt;lgl&gt;, merge_colspan &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   merge_rowspan &lt;dbl&gt;, merge_shape &lt;chr&gt;, cell_style &lt;chr&gt;, row_style &lt;chr&gt;</span></span></code></pre></div>
<p>The <code>penguins</code> sheet is a simple 6 rows by 4 columns sheet that stores the output of the following code:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">palmerpenguins</span><span class="fu">::</span><span class="va"><a href="https://allisonhorst.github.io/palmerpenguins/reference/penguins.html" class="external-link">penguins</a></span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html" class="external-link">drop_na</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">species</span>, female <span class="op">=</span> <span class="va">sex</span> <span class="op">==</span> <span class="st">"female"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">bill_length_mm</span>, <span class="va">body_mass_g</span><span class="op">)</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">.x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    .groups <span class="op">=</span> <span class="st">"drop"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 4</span></span>
<span><span class="co">#&gt;   species   female bill_length_mm body_mass_g</span></span>
<span><span class="co">#&gt;   &lt;fct&gt;     &lt;lgl&gt;           &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 Adelie    FALSE            40.4       4043.</span></span>
<span><span class="co">#&gt; 2 Adelie    TRUE             37.3       3369.</span></span>
<span><span class="co">#&gt; 3 Chinstrap FALSE            51.1       3939.</span></span>
<span><span class="co">#&gt; 4 Chinstrap TRUE             46.6       3527.</span></span>
<span><span class="co">#&gt; 5 Gentoo    FALSE            49.5       5485.</span></span>
<span><span class="co">#&gt; 6 Gentoo    TRUE             45.6       4680.</span></span></code></pre></div>
<p>There are functions to “rectify” a <a href="https://github.com/mattkerlogue/tidyods" class="external-link">tidyods</a> data.frame back to a traditional 2-dimensional array, the function <code><a href="reference/read_ods_sheet.html">read_ods_sheet()</a></code> combines <code><a href="reference/read_ods_cells.html">read_ods_cells()</a></code> and the rectify functions to easily import a dataset.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguin_sheet</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/read_ods_sheet.html">read_ods_sheet</a></span><span class="op">(</span><span class="va">example_file</span>, <span class="st">"penguins"</span>, quick <span class="op">=</span> <span class="cn">TRUE</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">penguin_sheet</span></span>
<span><span class="co">#&gt; # A tibble: 4 × 8</span></span>
<span><span class="co">#&gt;   col   `1`            `2`              `3`              `4`   `5`   `6`   `7`  </span></span>
<span><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt;          &lt;chr&gt;            &lt;chr&gt;            &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1 x1    species        Adelie           Adelie           Chin… Chin… Gent… Gent…</span></span>
<span><span class="co">#&gt; 2 x2    female         FALSE            TRUE             FALSE TRUE  FALSE TRUE </span></span>
<span><span class="co">#&gt; 3 x3    bill_length_mm 40.3904109589041 37.2575342465753 51.0… 46.5… 49.4… 45.5…</span></span>
<span><span class="co">#&gt; 4 x4    body_mass_g    4043.49315068493 3368.83561643836 3938… 3527… 5484… 4679…</span></span></code></pre></div>
<p>The <code>types</code> sheet shows examples of the different ODS data types:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">types_cells</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/read_ods_cells.html">read_ods_cells</a></span><span class="op">(</span><span class="va">example_file</span>, <span class="st">"types"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">types_cells</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">row</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">col</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 100</span></span>
<span><span class="co">#&gt; Columns: 25</span></span>
<span><span class="co">#&gt; Groups: col [10]</span></span>
<span><span class="co">#&gt; $ sheet           &lt;chr&gt; "types", "types", "types", "types", "types", "types", …</span></span>
<span><span class="co">#&gt; $ row             &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, …</span></span>
<span><span class="co">#&gt; $ col             &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 1, 2, 3, 4, 5, 6, 7, 8,…</span></span>
<span><span class="co">#&gt; $ cell_type       &lt;chr&gt; "cell", "cell", "cell", "cell", "cell", "cell", "cell"…</span></span>
<span><span class="co">#&gt; $ is_empty        &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE…</span></span>
<span><span class="co">#&gt; $ value_type      &lt;chr&gt; "string", "boolean", "currency", "date", "time", "date…</span></span>
<span><span class="co">#&gt; $ cell_content    &lt;chr&gt; "Cell", "TRUE", "£1.20", "15/06/22", "13:24:56", "15/0…</span></span>
<span><span class="co">#&gt; $ base_value      &lt;chr&gt; "Cell", "true", "1.2", "2022-06-15", "PT13H24M56S", "2…</span></span>
<span><span class="co">#&gt; $ numeric_value   &lt;dbl&gt; NA, NA, 1.2000, NA, NA, NA, 12034.5679, 0.5467, 6579.2…</span></span>
<span><span class="co">#&gt; $ currency_symbol &lt;chr&gt; NA, NA, "GBP", NA, NA, NA, NA, NA, NA, NA, NA, NA, "GB…</span></span>
<span><span class="co">#&gt; $ boolean_value   &lt;lgl&gt; NA, TRUE, NA, NA, NA, NA, NA, NA, NA, NA, NA, FALSE, N…</span></span>
<span><span class="co">#&gt; $ date_value      &lt;chr&gt; NA, NA, NA, "2022-06-15", NA, "2022-06-15T13:24:56", N…</span></span>
<span><span class="co">#&gt; $ time_value      &lt;chr&gt; NA, NA, NA, NA, "PT13H24M56S", NA, NA, NA, NA, NA, NA,…</span></span>
<span><span class="co">#&gt; $ has_formula     &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE…</span></span>
<span><span class="co">#&gt; $ formula         &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, "of:=[.G2]*[.H2]", "of…</span></span>
<span><span class="co">#&gt; $ has_error       &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE…</span></span>
<span><span class="co">#&gt; $ error_type      &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 7, NA, NA, NA, NA,…</span></span>
<span><span class="co">#&gt; $ has_annotation  &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE…</span></span>
<span><span class="co">#&gt; $ annotation      &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, "Test comment"…</span></span>
<span><span class="co">#&gt; $ is_merged       &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE…</span></span>
<span><span class="co">#&gt; $ merge_colspan   &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…</span></span>
<span><span class="co">#&gt; $ merge_rowspan   &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…</span></span>
<span><span class="co">#&gt; $ merge_shape     &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…</span></span>
<span><span class="co">#&gt; $ cell_style      &lt;chr&gt; NA, NA, "ce4", "ce11", "ce21", "ce31", "ce62", NA, NA,…</span></span>
<span><span class="co">#&gt; $ row_style       &lt;chr&gt; "ro1", "ro1", "ro1", "ro1", "ro1", "ro1", "ro1", "ro1"…</span></span>
<span></span>
<span><span class="va">types_cells</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">row</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">col</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">cell_type</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 20 × 24</span></span>
<span><span class="co">#&gt; # Groups:   col [10]</span></span>
<span><span class="co">#&gt;    sheet   row   col is_empty value_type cell_content   base_value numeric_value</span></span>
<span><span class="co">#&gt;    &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt;    &lt;chr&gt;      &lt;chr&gt;          &lt;chr&gt;              &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 types     2     1 FALSE    string     Cell           Cell              NA    </span></span>
<span><span class="co">#&gt;  2 types     3     1 FALSE    string     2022-06-16T00… 2022-06-1…        NA    </span></span>
<span><span class="co">#&gt;  3 types     2     2 FALSE    boolean    TRUE           true              NA    </span></span>
<span><span class="co">#&gt;  4 types     3     2 FALSE    boolean    FALSE          false             NA    </span></span>
<span><span class="co">#&gt;  5 types     2     3 FALSE    currency   £1.20          1.2                1.2  </span></span>
<span><span class="co">#&gt;  6 types     3     3 FALSE    currency   £1.20          1.2                1.2  </span></span>
<span><span class="co">#&gt;  7 types     2     4 FALSE    date       15/06/22       2022-06-15        NA    </span></span>
<span><span class="co">#&gt;  8 types     3     4 FALSE    date       06/15/22       2022-06-15        NA    </span></span>
<span><span class="co">#&gt;  9 types     2     5 FALSE    time       13:24:56       PT13H24M5…        NA    </span></span>
<span><span class="co">#&gt; 10 types     3     5 FALSE    time       13:24          PT13H24M5…        NA    </span></span>
<span><span class="co">#&gt; 11 types     2     6 FALSE    date       15/06/2022 13… 2022-06-1…        NA    </span></span>
<span><span class="co">#&gt; 12 types     3     6 FALSE    date       15/06/22 13:24 2022-06-1…        NA    </span></span>
<span><span class="co">#&gt; 13 types     2     7 FALSE    float      12035          12034.567…     12035.   </span></span>
<span><span class="co">#&gt; 14 types     3     7 FALSE    float      12034.57       12034.567…     12035.   </span></span>
<span><span class="co">#&gt; 15 types     2     8 FALSE    float      0.5467         0.5467             0.547</span></span>
<span><span class="co">#&gt; 16 types     3     8 FALSE    percentage 55%            0.5467             0.547</span></span>
<span><span class="co">#&gt; 17 types     2     9 FALSE    float      6579.3         6579.2982…      6579.   </span></span>
<span><span class="co">#&gt; 18 types     3     9 FALSE    float      6579.3         6579.2982…      6579.   </span></span>
<span><span class="co">#&gt; 19 types     2    10 FALSE    string     #N/A           #N/A              NA    </span></span>
<span><span class="co">#&gt; 20 types     3    10 FALSE    string     #DIV/0!        #DIV/0!           NA    </span></span>
<span><span class="co">#&gt; # ℹ 16 more variables: currency_symbol &lt;chr&gt;, boolean_value &lt;lgl&gt;,</span></span>
<span><span class="co">#&gt; #   date_value &lt;chr&gt;, time_value &lt;chr&gt;, has_formula &lt;lgl&gt;, formula &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   has_error &lt;lgl&gt;, error_type &lt;dbl&gt;, has_annotation &lt;lgl&gt;, annotation &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   is_merged &lt;lgl&gt;, merge_colspan &lt;dbl&gt;, merge_rowspan &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   merge_shape &lt;chr&gt;, cell_style &lt;chr&gt;, row_style &lt;chr&gt;</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="performance">Performance<a class="anchor" aria-label="anchor" href="#performance"></a>
</h2>
<p>An ODS file is a zipped collection of XML files and associated files. <a href="https://github.com/mattkerlogue/tidyods" class="external-link">tidyods</a>, like the <a href="https://docs.ropensci.org/readODS" class="external-link">readODS</a> package, uses the <a href="https://xml2.r-lib.org" class="external-link"><code>{xml2}</code></a> package to process this file. There are three likely sources of performance issues: downloading of remote files, unzipping the ODS file, processing rows.</p>
<p>With default settings, performance of <a href="https://github.com/mattkerlogue/tidyods" class="external-link">tidyods</a> functions is comparable to <a href="https://docs.ropensci.org/readODS" class="external-link">readODS</a> for small files, when working with larger files performance is somewhat quicker than <a href="https://docs.ropensci.org/readODS" class="external-link">readODS</a>.</p>
<p>Performance can be improved by setting <code>quick = TRUE</code> in <code><a href="reference/read_ods_cells.html">read_ods_cells()</a></code> and <code><a href="reference/read_ods_sheet.html">read_ods_sheet()</a></code>, this will extract only a simple text representation of the cell, i.e. it will not provide information on cell or value types, formulas or the underlying base value for numbers, dates or times.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">types_cells_quick</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/read_ods_cells.html">read_ods_cells</a></span><span class="op">(</span><span class="va">example_file</span>, <span class="st">"types"</span>, quick <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">types_cells_quick</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">row</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">col</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 100</span></span>
<span><span class="co">#&gt; Columns: 5</span></span>
<span><span class="co">#&gt; Groups: col [10]</span></span>
<span><span class="co">#&gt; $ sheet      &lt;chr&gt; "types", "types", "types", "types", "types", "types", "type…</span></span>
<span><span class="co">#&gt; $ row        &lt;int&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,…</span></span>
<span><span class="co">#&gt; $ col        &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 1, 2, 3, 4, 5, 6, 7, 8, 9, 1…</span></span>
<span><span class="co">#&gt; $ value_type &lt;chr&gt; "string", "boolean", "currency", "date", "time", "date", "f…</span></span>
<span><span class="co">#&gt; $ base_value &lt;chr&gt; "Cell", "TRUE", "£1.20", "15/06/22", "13:24:56", "15/06/202…</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>test_file <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">"extdata"</span>, <span class="st">"basic_example.ods"</span>, <span class="at">package =</span> <span class="st">"tidyods"</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>microbenchmark<span class="sc">::</span><span class="fu">microbenchmark</span>(</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="at">tidy_quick =</span> <span class="fu">read_ods_cells</span>(test_file, <span class="dv">1</span>, <span class="at">quick =</span> <span class="cn">TRUE</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span>),</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="at">tidy_slow =</span> <span class="fu">read_ods_cells</span>(test_file, <span class="dv">1</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span>),</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="at">tidy_sheet_quick =</span> <span class="fu">read_ods_sheet</span>(test_file, <span class="dv">1</span>, <span class="at">quick =</span> <span class="cn">TRUE</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span>),</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="at">tidy_sheet_slow =</span> <span class="fu">read_ods_sheet</span>(test_file, <span class="dv">1</span>, <span class="at">col_headers =</span> <span class="cn">FALSE</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span>),</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="at">read_ods =</span> readODS<span class="sc">::</span><span class="fu">read_ods</span>(test_file, <span class="dv">1</span>),</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="at">times =</span> <span class="dv">100</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span> )</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Unit: milliseconds</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              expr      min       lq     mean   median       uq       max neval</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        tidy_quick 15.27992 15.60860 16.31240 15.80013 16.07870  31.66500   100</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         tidy_slow 26.96623 27.66971 30.18053 27.99699 28.71550 125.81871   100</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  tidy_sheet_quick 19.86716 20.52970 22.55174 20.84087 21.70159  47.90370   100</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   tidy_sheet_slow 32.29455 33.28417 35.45937 33.90800 34.99032  44.82710   100</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          read_ods 21.84952 22.42372 23.44579 22.63387 23.04967  33.24858   100</span></span></code></pre></div>
<p>To test real-world performance we will use an ODS file published by the UK Government on the <a href="https://www.gov.uk/government/statistics/number-of-civil-servants-by-postcode-department-responsibility-level-and-leaving-cause-2021" class="external-link">number of civil servants by postcode</a>, a sheet of 5,544 rows by 11 columns.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>postcodes_file <span class="ot">&lt;-</span> <span class="fu">system.file</span>(</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"extdata"</span>,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Civil-servants-by-postcode-department-responsibility-level-and-leaving-cause-2021.ods"</span>,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">package =</span> <span class="st">"tidyods"</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>microbenchmark<span class="sc">::</span><span class="fu">microbenchmark</span>(</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="at">tidy_quick =</span> <span class="fu">read_ods_cells</span>(postcodes_file, <span class="dv">2</span>, <span class="at">quick =</span> <span class="cn">TRUE</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span>),</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="at">tidy_slow =</span> <span class="fu">read_ods_cells</span>(postcodes_file, <span class="dv">2</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span>),</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="at">tidy_sheet_quick =</span> <span class="fu">read_ods_sheet</span>(postcodes_file, <span class="dv">2</span>, <span class="at">quick =</span> <span class="cn">TRUE</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span>),</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="at">tidy_sheet_slow =</span> <span class="fu">read_ods_sheet</span>(postcodes_file, <span class="dv">2</span>, <span class="at">col_headers =</span> <span class="cn">FALSE</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span>),</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="at">read_ods =</span> readODS<span class="sc">::</span><span class="fu">read_ods</span>(postcodes_file, <span class="dv">2</span>),</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="at">times =</span> <span class="dv">10</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span> )</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Unit: seconds</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              expr       min        lq      mean    median        uq       max neval</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        tidy_quick  4.055970  4.063083  4.146814  4.124268  4.202820  4.344831    10</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         tidy_slow  5.844290  6.010520  6.071356  6.058574  6.183601  6.243177    10</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  tidy_sheet_quick  4.112764  4.194695  4.325126  4.298507  4.438064  4.574808    10</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   tidy_sheet_slow  6.037985  6.150493  6.217836  6.220751  6.315860  6.413734    10</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          read_ods 10.505124 10.961019 11.263066 11.217981 11.605392 12.229583    10</span></span></code></pre></div>
<p>The dependency on <a href="https://xml2.r-lib.org/" class="external-link">xml2</a> is likely to cause the function to fail/crash when working with exceptionally large files.</p>
<p>Performance issues are tracked and discussed in <a href="https://github.com/mattkerlogue/tidyods/issues/3" class="external-link">issue #3</a> in the package’s GitHub repository.</p>
</div>
<div class="section level2">
<h2 id="related-projects">Related projects<a class="anchor" aria-label="anchor" href="#related-projects"></a>
</h2>
<p>The <code>{tidyODS}</code> package is heavily inspired by three existing packages:</p>
<ul>
<li>The <a href="https://github.com/chainsawriot/readODS" class="external-link"><code>{readODS}</code></a> package provides functionality to read and write ODS files with R, with the resulting data.frame reflecting the way the data is viewed in a spreadsheet editor application (i.e a two-dimension table structure).</li>
<li>The <a href="https://nacnudus.github.io/tidyxl/" class="external-link"><code>{tidyxl}</code></a> package reads cells from Excel files and provides a data.frame where each cell is its own row and columns provide information about the cell’s location, value and value type, formula and formatting.</li>
<li>The <a href="https://nacnudus.github.io/unpivotr/" class="external-link"><code>{unpivotr}</code></a> package works with datasets of cells (such as those created by tidyxl).</li>
</ul>
</div>
<div class="section level2">
<h2 id="philosophy">Philosophy<a class="anchor" aria-label="anchor" href="#philosophy"></a>
</h2>
<p>The <a href="https://docs.ropensci.org/readODS" class="external-link">readODS</a> package is the only package on CRAN that handles the reading of ODS files, whereas there are more than 20 packages (as at 12 June 2022) on CRAN that work with Excel files (of which <a href="https://github.com/nacnudus/tidyxl" class="external-link">tidyxl</a> is one). In some respects this is due to the wider usage of Excel files by businesses, governments, academia and other organisations to publish and share data. Various governments and international organisations are starting to mandate the use of OpenDocument Format files for publishing of their information.</p>
<p>The initial purpose of <a href="https://github.com/mattkerlogue/tidyods" class="external-link">tidyods</a> was to provide a second package to the R ecosystem for reading ODS files, in part prompted when encountering an error with <a href="https://docs.ropensci.org/readODS" class="external-link">readODS</a> and discovering no alternative package was available. This is not the same when working with Excel spreadsheets, for example if you run into an error when using the <a href="https://readxl.tidyverse.org" class="external-link">readxl</a> package you could use easily try the <a href="https://ycphs.github.io/openxlsx/index.html" class="external-link">openxlsx</a> or <a href="https://github.com/colearendt/xlsx" class="external-link">xlsx</a> packages instead.</p>
<p>The initial conceptual development of code lead to the creation of an output dataset similar to that produced by the <a href="https://github.com/nacnudus/tidyxl" class="external-link">tidyxl</a> package. Thus, <a href="https://github.com/mattkerlogue/tidyods" class="external-link">tidyods</a> extracts cells from an ODS document in the same manner as <a href="https://github.com/nacnudus/tidyxl" class="external-link">tidyxl</a>, but includes functions to “rectify” the cells so as to also provide an output similar to that of <a href="https://docs.ropensci.org/readODS" class="external-link">readODS</a> (and many of those that read Excel files). This is similar to the <a href="https://nacnudus.github.io/unpivotr/reference/rectify.html" class="external-link">rectify</a> function in the <a href="https://github.com/nacnudus/unpivotr" class="external-link">unpivotr</a> package.</p>
</div>
<div class="section level2">
<h2 id="code-of-conduct">Code of Conduct<a class="anchor" aria-label="anchor" href="#code-of-conduct"></a>
</h2>
<p>Please note that the tidyods project is released with a <a href="CODE_OF_CONDUCT.html">Contributor Code of Conduct</a>. By contributing to this project, you agree to abide by its terms. Please read the <a href="CONTRIBUTING.html">contributing guidelines</a>.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/mattkerlogue/tidyods/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/mattkerlogue/tidyods/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing tidyods</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Matt Kerlogue <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://www.repostatus.org/#concept" class="external-link"><img src="https://www.repostatus.org/badges/latest/concept.svg" alt="Project Status: Concept – Minimal or no implementation has been done yet, or the repository is only intended to be a limited example, demo, or proof-of-concept."></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Matt Kerlogue.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>

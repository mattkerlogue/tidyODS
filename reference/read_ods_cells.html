<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Import cells from an OpenDocument Spreadsheet (ODS) file. In the resulting
dataaset each cell is its own row with columns providing information about
the cell's postion, value types and containing formulas."><title>Read cells from an ODS sheet — read_ods_cells • tidyods</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Read cells from an ODS sheet — read_ods_cells"><meta property="og:description" content="Import cells from an OpenDocument Spreadsheet (ODS) file. In the resulting
dataaset each cell is its own row with columns providing information about
the cell's postion, value types and containing formulas."><meta property="og:image" content="https://mattkerlogue.github.io/tidyODS/reference/figures/tidyods_hex_banner.png"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@mattkerlogue"><meta name="twitter:site" content="@mattkerlogue"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">tidyods</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mattkerlogue/tidyods/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Read cells from an ODS sheet</h1>
      <small class="dont-index">Source: <a href="https://github.com/mattkerlogue/tidyods/blob/HEAD/R/read.R" class="external-link"><code>R/read.R</code></a></small>
      <div class="d-none name"><code>read_ods_cells.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Import cells from an OpenDocument Spreadsheet (ODS) file. In the resulting
dataaset each cell is its own row with columns providing information about
the cell's postion, value types and containing formulas.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">read_ods_cells</span><span class="op">(</span><span class="va">path</span>, sheet <span class="op">=</span> <span class="fl">1</span>, quick <span class="op">=</span> <span class="cn">FALSE</span>, whitespace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>path</dt>
<dd><p>The ODS file</p></dd>


<dt>sheet</dt>
<dd><p>The sheet within the ODS file</p></dd>


<dt>quick</dt>
<dd><p>Whether to use the quick reading process</p></dd>


<dt>whitespace</dt>
<dd><p>Whether to process multiple whitespaces</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A tibble with the following information:</p><ul><li><p><code>row</code>: the row number of the cell</p></li>
<li><p><code>col</code>: the column number of the cell</p></li>
<li><p><code>cell_type</code>: the type of cell, either "cell", "empty" or "merged"</p></li>
<li><p><code>value_type</code>: the ODS value type (see details)</p></li>
<li><p><code>cell_formula</code>: the ODS formula specification</p></li>
<li><p><code>cell_content</code>: the value of the cell as represented to the user of a
spreadsheet application (i.e. with text formatting applied)</p></li>
<li><p><code>base_value</code>: the underlying value of a cell (see details)</p></li>
<li><p><code>currency symbol</code>: the currency symbol for cells with a <code>value_type</code> of
currency</p></li>
</ul><p>If using the <code>quick</code> argument you only <code>row</code>, <code>col</code> and <code>cell_content</code> are
returned.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Cells are assigned a <code>cell_type</code> of "cell" when they have content, "empty"
if they have no content, or "merged" if they are part of a set of merged cells.</p>
<p>The <code>value_type</code> of a cell is based on the <a href="https://docs.oasis-open.org/office/OpenDocument/v1.3/os/part3-schema/OpenDocument-v1.3-os-part3-schema.html#__RefHeading__1417680_253892949" class="external-link">"value-type" attribute</a>
defined by the OpenDocument Format specification. There are 7 value types:</p><ul><li><p><code>boolean</code>: equivalent to R's <code><a href="https://rdrr.io/r/base/logical.html" class="external-link">base::logical()</a></code> data type</p></li>
<li><p><code>currency</code>: a numeric value, optionally with a currency symbol</p></li>
<li><p><code>date</code>: a date or date-time stored in ISO format</p></li>
<li><p><code>float</code>: a numeric value, the ODS format does not distinguish between
different numeric types</p></li>
<li><p><code>percentage</code>: a numeric value, formatted for display as a percentage</p></li>
<li><p><code>string</code>: equivalent to R's <code><a href="https://rdrr.io/r/base/character.html" class="external-link">base::character()</a></code></p></li>
<li><p><code>time</code>: a duration, stored in ISO format</p></li>
</ul><p>For currency value types optionally a currency symbol (e.g. GBP, EUR, USD) can
be set, this is provided separate from the <code>base_value</code> as <code>currency_symbol</code>.</p>
<p><code>read_ods_cells</code> provides two representations of a cell's value. The
<code>cell_content</code> column provides the cell's value as presented to the user of
a traditional spreadsheet application (such as Microsoft Excel, Google Sheets
or LibreOffice Calc), i.e. after applying cell formatting rules. The
<code>base_value</code> column provides the cell's underlying value, i.e. without
formatting.</p>
<p>Processing the ODS XML is a memory intensive process, you can achieve
significant speed enhancements by setting the <code>quick</code> argument to FALSE,
this will extract only the text content of the cell. Note this also ignores
repeated white space elements (i.e. <code>"A   B   C"</code> will be returned as
<code>"A B C"</code>).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="va">example</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"basic_example.ods"</span>, package <span class="op">=</span> <span class="st">"tidyods"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">example_cells</span> <span class="op">&lt;-</span> <span class="fu">read_ods_cells</span><span class="op">(</span><span class="va">example</span>, <span class="fl">1</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Unzipping ODS file</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading XML file</span>
<span class="r-in"><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">example_cells</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Rows: 28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Columns: 13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ sheet           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "penguins", "penguins", "penguins", "penguins", "pengu…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ row             <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, …</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ col             <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4, 1, 2, …</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ cell_type       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "cell", "cell", "cell", "cell", "cell", "cell", "cell"…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ value_type      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "string", "string", "string", "string", "string", "boo…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ cell_content    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "species", "female", "bill_length_mm", "body_mass_g", …</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ base_value      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "species", "female", "bill_length_mm", "body_mass_g", …</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ numeric_value   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> NA, NA, NA, NA, NA, NA, 40.39041, 4043.49315, NA, NA, …</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ logical_value   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> NA, NA, NA, NA, NA, FALSE, NA, NA, NA, TRUE, NA, NA, N…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ currency_symbol <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ has_formula     <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ cell_formula    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ error           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…</span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Matt Kerlogue.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.4.</p>
</div>

    </footer></div>

  

  

  </body></html>


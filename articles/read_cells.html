<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="tidyods">
<title>Extracting cell information • tidyods</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><link href="../deps/Heebo-0.4.6/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.6/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Extracting cell information">
<meta property="og:description" content="tidyods">
<meta property="og:image" content="https://mattkerlogue.github.io/tidyODS/reference/figures/tidyods_hex_banner.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@mattkerlogue">
<meta name="twitter:site" content="@mattkerlogue">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">tidyods</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/read_cells.html">Extracting cell information</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mattkerlogue/tidyods/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Extracting cell information</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mattkerlogue/tidyods/blob/HEAD/vignettes/read_cells.Rmd" class="external-link"><code>vignettes/read_cells.Rmd</code></a></small>
      <div class="d-none name"><code>read_cells.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mattkerlogue/tidyods" class="external-link">tidyods</a></span><span class="op">)</span></span></code></pre></div>
<p>The aim of <a href="https://github.com/mattkerlogue/tidyods" class="external-link">tidyods</a> is to extract information about
cells in OpenDocument Spreadsheet (ODS) files into a “tidy” format. In
addition to the value contained by a cell it extracts a range of
addition metadata about the cells.</p>
<p>This vignette explains how to use
<code><a href="../reference/read_ods_cells.html">tidyods::read_ods_cells()</a></code> and the types of information
about cells it extracts. The <a href="https://nacnudus.github.io/spreadsheet-munging-strategies/index.html" class="external-link"><em>Spreadsheet
Munging Strategies</em></a> book by Duncan Garmonsway explores in more
detail how you can use datasets of “tidy cells” to work with non-tabular
data stored in (Excel) spreadsheets.</p>
<div class="section level2">
<h2 id="reading-data-from-cells">Reading data from cells<a class="anchor" aria-label="anchor" href="#reading-data-from-cells"></a>
</h2>
<p>You read in data from an ODS file with the
<code><a href="../reference/read_ods_cells.html">read_ods_cells()</a></code> function. The resulting tibble provides 28
columns of information about cells, with each row representing an
individual cell in the input spreadsheet.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"basic_example.ods"</span>, package <span class="op">=</span> <span class="st">"tidyods"</span><span class="op">)</span></span>
<span><span class="va">types_cells</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_ods_cells.html">read_ods_cells</a></span><span class="op">(</span><span class="va">example_file</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">types_cells</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 160</span></span>
<span><span class="co">#&gt; Columns: 28</span></span>
<span><span class="co">#&gt; $ sheet                  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "types", "types", "types", "types", "types", "t…</span></span>
<span><span class="co">#&gt; $ address                <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "A1", "B1", "C1", "D1", "E1", "F1", "G1", "H1",…</span></span>
<span><span class="co">#&gt; $ row                    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2,…</span></span>
<span><span class="co">#&gt; $ col                    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 1, 2, 3, 4, 5, 6…</span></span>
<span><span class="co">#&gt; $ cell_type              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "cell", "cell", "cell", "cell", "cell", "cell",…</span></span>
<span><span class="co">#&gt; $ is_empty               <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE…</span></span>
<span><span class="co">#&gt; $ value_type             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "string", "string", "string", "string", "string…</span></span>
<span><span class="co">#&gt; $ cell_content           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "String", "Boolean", "Currency", "Date", "Time"…</span></span>
<span><span class="co">#&gt; $ base_value             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "String", "Boolean", "Currency", "Date", "Time"…</span></span>
<span><span class="co">#&gt; $ numeric_value          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…</span></span>
<span><span class="co">#&gt; $ currency_symbol        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…</span></span>
<span><span class="co">#&gt; $ boolean_value          <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, TRU…</span></span>
<span><span class="co">#&gt; $ date_value             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…</span></span>
<span><span class="co">#&gt; $ time_value             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…</span></span>
<span><span class="co">#&gt; $ has_formula            <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE…</span></span>
<span><span class="co">#&gt; $ formula                <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…</span></span>
<span><span class="co">#&gt; $ has_error              <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE…</span></span>
<span><span class="co">#&gt; $ error_type             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…</span></span>
<span><span class="co">#&gt; $ has_annotation         <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE…</span></span>
<span><span class="co">#&gt; $ annotation             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…</span></span>
<span><span class="co">#&gt; $ is_merged              <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE…</span></span>
<span><span class="co">#&gt; $ merge_colspan          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…</span></span>
<span><span class="co">#&gt; $ merge_rowspan          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…</span></span>
<span><span class="co">#&gt; $ merge_shape            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…</span></span>
<span><span class="co">#&gt; $ cell_style             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> NA, "Default", "Default", "Default", "Default",…</span></span>
<span><span class="co">#&gt; $ row_style              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "ro1", "ro1", "ro1", "ro1", "ro1", "ro1", "ro1"…</span></span>
<span><span class="co">#&gt; $ col_style              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "co6", "co7", "co8", "co9", "co10", "co11", "co…</span></span>
<span><span class="co">#&gt; $ col_default_cell_style <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Default", "ce56", "ce4", "ce11", "ce21", "ce31…</span></span></code></pre></div>
<p>There are four arguments to <code><a href="../reference/read_ods_cells.html">read_ods_cells()</a></code>:</p>
<ul>
<li>
<code>path</code>, the path to the ODS file</li>
<li>
<code>sheet</code>, the sheet you wish to extract</li>
<li>
<code>quick</code>, whether to extract a subset of cell
information</li>
<li>
<code>quiet</code>, whether to show console messages or not</li>
</ul>
<p>The <code>sheet</code> argument can either be the index number of a
sheet (ranging from 1 to the total number of sheets in the spreadsheet
document) or the name of a sheet (e.g. <code>"types"</code> instead of
<code>2</code> in the example above).</p>
<p>The <code>quick</code> argument extracts only a small number of
columns and is useful if you are largely concerned with cell values; see
the <a href="#quick-extraction">quick extraction</a> section for more
details.</p>
<p>The <code>quiet</code> argument turns off console messages, ODS files
are written in XML which can take significant time to process and so
progress messages are provided to the console for interactive users. It
is advised to set this to false if you are doing batch operations.</p>
</div>
<div class="section level2">
<h2 id="cell-information">Cell information<a class="anchor" aria-label="anchor" href="#cell-information"></a>
</h2>
<p>There are 28 types of information returned by
<code><a href="../reference/read_ods_cells.html">read_ods_cells()</a></code>, these can be grouped into three
categories: location information, value information, and other
metadata.</p>
<div class="section level3">
<h3 id="location-information">Location information<a class="anchor" aria-label="anchor" href="#location-information"></a>
</h3>
<p>The first four columns of information relate to a cell’s location in
the spreadsheet.</p>
<ul>
<li>
<code>sheet</code>, the name of the sheet the cell belongs to</li>
<li>
<code>address</code>, the address of the cell within a sheet using
“A1” notation</li>
<li>
<code>row</code>, the row number of the cell</li>
<li>
<code>col</code>, the column number of the cell</li>
</ul>
<p>The <code>address</code> column is derived from the <code>row</code>
and <code>col</code> using the <a href="https://github.com/rsheets/cellranger" class="external-link">cellranger</a> package. It
provides the address in the “A1” notation commonly used in spreadsheet
applications where the letter corresponds to a column and the number
corresponds to a row. The “A1” notation is used by ODS files for
calculation formulas.</p>
</div>
<div class="section level3">
<h3 id="value-information">Value information<a class="anchor" aria-label="anchor" href="#value-information"></a>
</h3>
<p>There are 10 columns that provide information about a cell’s
value.</p>
<ul>
<li>
<code>cell_type</code>, the type of cell</li>
<li>
<code>is_empty</code>, whether the cell has content or not
(i.e. <code>cell_type == "empty"</code>)</li>
<li>
<code>value_type</code>, the value type as set in the ODS file</li>
<li>
<code>cell_content</code>, the cell’s value as formatted for users
of spreadsheet applications</li>
<li>
<code>base_value</code>, the “raw” value of the cell</li>
<li>
<code>numeric_value</code>, for numeric value types the raw value as
a <code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric()</a></code> vector</li>
<li>
<code>currency_symbol</code>, for currency value types the currency
symbol associated with the numeric value</li>
<li>
<code>boolean_value</code>, for boolean value types the raw value as
a <code><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical()</a></code> vector</li>
<li>
<code>date_value</code>, for date value types (dates and date-times)
the “raw” value as a <code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code> vector</li>
<li>
<code>time_value</code>, for time value types, the “raw” value as a
<code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code> vector</li>
</ul>
<p>Cells have one of four types, it is <code>empty</code> if it has no
content and/or no value type, it is a <code>merge-lead</code> if it is
the top-left cell of a merge group while other cells in the merge group
are classified as <code>merge-hidden</code>, all other cells are simply
a <code>cell</code>.</p>
<p>The <code>value_type</code> is derived from the <a href="https://docs.oasis-open.org/office/OpenDocument/v1.3/os/part3-schema/OpenDocument-v1.3-os-part3-schema.html#__RefHeading__1417680_253892949" class="external-link">ODS
specification</a> which defines seven value types:</p>
<ul>
<li>
<code>boolean</code>, equivalent to R’s <code><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical()</a></code> data
type</li>
<li>
<code>currency</code>, a numeric value, optionally with a currency
symbol</li>
<li>
<code>date</code>, a date or date-time stored in ISO 8601 format,
the ODS specification does not differentiate between a date
(e.g. 15/06/2022) and a date-time (e.g. 15/06/2023 13:47)</li>
<li>
<code>float</code>, a numeric value, the ODS format does not
distinguish between different numeric types</li>
<li>
<code>percentage</code>, a numeric value, but formatted for display
as a percentage</li>
<li>
<code>string</code>, equivalent to R’s <code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code>
</li>
<li>
<code>time</code>, a duration, stored in ISO 8601 format</li>
</ul>
<p>The <code>cell_content</code> column provides the value of a cell as
displayed and formatted to users of a spreadsheet application.
Non-string values are stored separately in the underlying ODS XML file,
and these are extracted as separate columns (<code>numeric_value</code>,
<code>boolean_value</code>, <code>date_value</code> and
<code>time_value</code>) by <code><a href="../reference/read_ods_cells.html">read_ods_cells()</a></code>, for numeric
and boolean values these are also coerced into a <code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric()</a></code>
and <code><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical()</a></code> vector. The <code>base_value</code> column
provides a combination of the <code>cell_content</code> for cells that
are strings and for cells that are not string value types the value from
the relevant type specific column.</p>
<p>For currency value types optionally a currency symbol (e.g. GBP, EUR,
USD, JPY) can be set, this is provided in the
<code>currency_symbol</code> column.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">types_cells</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">row</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">value_type</span><span class="op">:</span><span class="va">currency_symbol</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 5</span></span></span>
<span><span class="co">#&gt;    value_type cell_content      base_value         numeric_value currency_symbol</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> string     Cell with comment Cell with comment         <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> boolean    FALSE             false                     <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> currency   £1.20             1.2                        1.2   GBP            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> date       06/15/22          2022-06-15                <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> time       13:24             PT13H24M56S               <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> date       15/06/22 13:24    2022-06-15T13:24:…        <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> float      12034.57          12034.56789            <span style="text-decoration: underline;">12</span>035.    <span style="color: #BB0000;">NA</span>             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> percentage 55%               0.5467                     0.547 <span style="color: #BB0000;">NA</span>             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> float      6579.3            6579.298265463          <span style="text-decoration: underline;">6</span>579.    <span style="color: #BB0000;">NA</span>             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> string     #DIV/0!           #DIV/0!                   <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span></span></span>
<span></span>
<span><span class="va">types_cells</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">row</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">value_type</span>, <span class="va">base_value</span>, <span class="va">boolean_value</span><span class="op">:</span><span class="va">time_value</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 5</span></span></span>
<span><span class="co">#&gt;    value_type base_value          boolean_value date_value          time_value </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> string     Cell with comment   <span style="color: #BB0000;">NA</span>            <span style="color: #BB0000;">NA</span>                  <span style="color: #BB0000;">NA</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> boolean    false               FALSE         <span style="color: #BB0000;">NA</span>                  <span style="color: #BB0000;">NA</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> currency   1.2                 <span style="color: #BB0000;">NA</span>            <span style="color: #BB0000;">NA</span>                  <span style="color: #BB0000;">NA</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> date       2022-06-15          <span style="color: #BB0000;">NA</span>            2022-06-15          <span style="color: #BB0000;">NA</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> time       PT13H24M56S         <span style="color: #BB0000;">NA</span>            <span style="color: #BB0000;">NA</span>                  PT13H24M56S</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> date       2022-06-15T13:24:56 <span style="color: #BB0000;">NA</span>            2022-06-15T13:24:56 <span style="color: #BB0000;">NA</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> float      12034.56789         <span style="color: #BB0000;">NA</span>            <span style="color: #BB0000;">NA</span>                  <span style="color: #BB0000;">NA</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> percentage 0.5467              <span style="color: #BB0000;">NA</span>            <span style="color: #BB0000;">NA</span>                  <span style="color: #BB0000;">NA</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> float      6579.298265463      <span style="color: #BB0000;">NA</span>            <span style="color: #BB0000;">NA</span>                  <span style="color: #BB0000;">NA</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> string     #DIV/0!             <span style="color: #BB0000;">NA</span>            <span style="color: #BB0000;">NA</span>                  <span style="color: #BB0000;">NA</span></span></span></code></pre></div>
<p>The <a href="#value-types-examples">value type examples</a> section
below provides more details on the different value types and how they
are stored and processed.</p>
</div>
<div class="section level3">
<h3 id="other-metadata">Other metadata<a class="anchor" aria-label="anchor" href="#other-metadata"></a>
</h3>
<p>Finally, <code><a href="../reference/read_ods_cells.html">read_ods_cells()</a></code> provides 12 further columns
with additional metadata about each cell.</p>
<ul>
<li>
<code>has_formula</code>, whether the cell value is calculated by a
formula</li>
<li>
<code>formula</code>, the formula used to calculate the cell
value</li>
<li>
<code>has_error</code>, whether the cell value or formula results in
an error</li>
<li>
<code>error_type</code>, the type of error the cell is
experiencing</li>
<li>
<code>has_annotation</code>, whether the cell has a
comment/annotation</li>
<li>
<code>annotation</code>, the content of the cell’s
comment/annotation</li>
<li>
<code>is_merged</code>, whether the cell is part of a merge
group</li>
<li>
<code>merge_colspan</code>, for the lead cell in a merge group the
number of columns spanned by the merge group</li>
<li>
<code>merge_rowspan</code>, for the lead cell in a merge group the
number of rows spanned by the merge group</li>
<li>
<code>merge_shape</code>, for the lead cell in a merge group the
shape of the merge group</li>
<li>
<code>cell_style</code>, the style reference for the cell</li>
<li>
<code>row_style</code>, the style reference for the row</li>
<li>
<code>col_style</code>, the style reference for the column</li>
<li>
<code>col_deftaul_cell_style</code>, the default style reference for
cells in the column</li>
</ul>
<div class="section level4">
<h4 id="formulas">Formulas<a class="anchor" aria-label="anchor" href="#formulas"></a>
</h4>
<p>The <code>has_formula</code> column indicates if a cell value is
calculated by a formula, which is itself provided in the
<code>formula</code> column.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">types_cells</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">col</span> <span class="op">==</span> <span class="fl">9</span> <span class="op">&amp;</span> <span class="va">has_formula</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">value_type</span>, <span class="va">cell_content</span>, <span class="va">numeric_value</span>, <span class="va">has_formula</span>, <span class="va">formula</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 5</span></span></span>
<span><span class="co">#&gt;   value_type cell_content numeric_value has_formula formula        </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> float      6579.3               <span style="text-decoration: underline;">6</span>579. TRUE        of:=[.G2]*[.H2]</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> float      6579.3               <span style="text-decoration: underline;">6</span>579. TRUE        of:=[.G3]*[.H3]</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> float      6579.3               <span style="text-decoration: underline;">6</span>579. TRUE        of:=[.G4]*[.H4]</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> float      6579.3               <span style="text-decoration: underline;">6</span>579. TRUE        of:=[.G5]*[.H5]</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> float      6579.3               <span style="text-decoration: underline;">6</span>579. TRUE        of:=[.G6]*[.H6]</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> float      6579.3               <span style="text-decoration: underline;">6</span>579. TRUE        of:=[.G7]*[.H7]</span></span></code></pre></div>
<p>For more on the use of formulas in ODS files you can consult the <a href="https://docs.oasis-open.org/office/OpenDocument/v1.3/os/part4-formula/OpenDocument-v1.3-os-part4-formula.html" class="external-link">OpenFormula
specification</a>.</p>
</div>
<div class="section level4">
<h4 id="errors">Errors<a class="anchor" aria-label="anchor" href="#errors"></a>
</h4>
<p>Formulas in spreadsheets can result in calculation errors. The
<code>has_error</code> column indicates if there the cell results in an
error. The <code>error_type</code> column is similar to the
<code>=ERROR.TYPE()</code> function in Microsoft Excel, Google Sheets
and LibreOffice, these provide a number to denote the type of error.</p>
<p><code>error_type</code> will have a value from 1 to 7 or 501 to
540:</p>
<ul>
<li>
<code>1</code> for #NULL! errors in Excel/Google Sheets or Err:511
in LibreOffice, typically this is some sort of error in the formula
specification such as a missing operator (Excel/Google Sheets) or a
missing variable (LibreOffice)</li>
<li>
<code>2</code> for #DIV/0! (division by zero) errors</li>
<li>
<code>3</code> for #VALUE! (value type) errors, e.g. when a formula
uses a string rather than a number</li>
<li>
<code>4</code> for #REF! (invalid cell reference) errors</li>
<li>
<code>5</code> for #NAME? errors, e.g. formula specifies a function
that doesn’t exist</li>
<li>
<code>6</code> for #NUM! (calculation overflow) errors, e.g. the
result of <code>9999^9999</code>
</li>
<li>
<code>7</code> for #N/A (logic) errors, e.g. unable to match
values</li>
<li>
<code>501</code> to <code>540</code> a LibreOffice error</li>
</ul>
<p>LibreOffice assigns all errors an error code from 501 to 540, where
not displayed as an error like <code>#DIV/0!</code> these are shown in
<code>cell_content</code> as <code>"Err:5##"</code>. See LibreOffice’s
documentation on <a href="https://help.libreoffice.org/7.3/en-GB/text/scalc/05/02140000.html" class="external-link">error
codes</a> for more details on these error codes.</p>
</div>
<div class="section level4">
<h4 id="annotations">Annotations<a class="anchor" aria-label="anchor" href="#annotations"></a>
</h4>
<p>Spreadsheet applications allow you to add notes and comments to cells
to provide addition contextual information. The
<code>has_annotation</code> column indicates whether the cell has an
annotation associated with it. The <code>annotation</code> column
provides the text content of the annotation.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">types_cells</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">has_annotation</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">has_annotation</span>, <span class="va">annotation</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 2</span></span></span>
<span><span class="co">#&gt;   has_annotation annotation                                                   </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                                        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> TRUE           <span style="color: #949494;">"</span>Test comment<span style="color: #949494;">"</span>                                               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> TRUE           <span style="color: #949494;">"</span>Comment 2\nMore comments\nComments with space\nBold comment<span style="color: #949494;">"</span></span></span></code></pre></div>
<p><strong>Note:</strong> different spreadsheet applications handle
annotations in different ways, <code><a href="../reference/read_ods_cells.html">read_ods_cells()</a></code> does not
take account of these differences and provides only a basic
representation of the text contained in the annotation. LibreOffice only
supports a basic “comment” annotation which is called a “note” in
Microsoft Excel and Google Sheets.</p>
<p>In addition to a “note” Microsoft Excel and Google Sheets proprietary
formats allow for threaded comments that allow users to leave comments
and reply to these comments, when saving into ODS these features are
saved as annotations like notes. However the coercion of these threads
into a note and inclusion of comment/reply author details varies.</p>
</div>
<div class="section level4">
<h4 id="merged-cells">Merged cells<a class="anchor" aria-label="anchor" href="#merged-cells"></a>
</h4>
<p>Spreadsheets allow you to merge cells, largely this is for
presentational purposes. Merged cells have a <code>cell_type</code> of
either <code>merge-lead</code> for the top-left cell of a merge group or
<code>merge-hidden</code> for a cell hidden by a merge group. The
<code>is_merged</code> indicates whether the cell is either of these
types.</p>
<p>When merging cells in Microsoft Office and Google Sheets then only
content in the top-left cell is retained, however in LibreOffice merging
cells retains the content of the cells that are hidden by a merge
operation.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">types_cells</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">is_merged</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">address</span>, <span class="va">cell_type</span>, <span class="va">cell_content</span>, <span class="va">is_merged</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 4</span></span></span>
<span><span class="co">#&gt;   address cell_type    cell_content                 is_merged</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                        <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> A8      merge-lead   Merged cell                  TRUE     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> A9      merge-hidden <span style="color: #BB0000;">NA</span>                           TRUE     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> A10     merge-lead   Merged cell with hidden text TRUE     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> A11     merge-hidden Hidden text                  TRUE</span></span></code></pre></div>
<p>For <code>merge-lead</code> cells you will also get the number of
columns and rows spanned by the merge group in
<code>merge_colspan</code> and <code>merge_rowspan</code> respectively.
This span information is used to define the <code>merge_shape</code>
column:</p>
<ul>
<li>the shape of a merge group is defined as <code>vertical</code> when
<code>merge_colspan</code> is equal to 1 and <code>merge_rowspan</code>
is greater than 1</li>
<li>the shape of a merge group is defined as <code>horizontal</code>
when <code>merge_colspan</code> is greater than 1 and
<code>merge_rowspan</code> is equal to 1</li>
<li>otherwise the shape of the merge group is
<code>rectangular</code>.</li>
</ul>
<table style="width:100%" class="table">
<thead><tr>
<th style="width:4%">
</th>
<th style="width:24%">
A
</th>
<th style="width:24%">
B
</th>
<th style="width:24%">
C
</th>
<th style="width:24%">
D
</th>
</tr></thead>
<tbody>
<tr>
<th>
1
</th>
<td colspan="2">
A cell across two columns (a horizontal merge)
</td>
<td>
C1
</td>
<td>
D1
</td>
</tr>
<tr>
<th>
2
</th>
<td rowspan="2">
A cell across two rows (a vertical merge)
</td>
<td>
B2
</td>
<td>
C2
</td>
<td>
D2
</td>
</tr>
<tr>
<th>
3
</th>
<td>
B3
</td>
<td>
C3
</td>
<td>
D3
</td>
</tr>
<tr>
<th>
4
</th>
<td>
A4
</td>
<td>
B4
</td>
<td colspan="2" rowspan="2">
A cell across two columns and two rows (a rectangular merge)
</td>
</tr>
<tr>
<th>
5
</th>
<td>
A5
</td>
<td>
B5
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">merge_cells</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_ods_cells.html">read_ods_cells</a></span><span class="op">(</span><span class="va">example_file</span>, <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">merge_cells</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">row</span>, <span class="va">col</span>, <span class="va">cell_type</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="va">col</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">col</span>, values_from <span class="op">=</span> <span class="va">cell_type</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 5</span></span></span>
<span><span class="co">#&gt;     row x1           x2           x3           x4          </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1 merge-lead   merge-hidden <span style="color: #BB0000;">NA</span>           <span style="color: #BB0000;">NA</span>          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     2 merge-lead   <span style="color: #BB0000;">NA</span>           <span style="color: #BB0000;">NA</span>           <span style="color: #BB0000;">NA</span>          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     3 merge-hidden <span style="color: #BB0000;">NA</span>           <span style="color: #BB0000;">NA</span>           <span style="color: #BB0000;">NA</span>          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>     4 empty        empty        merge-lead   merge-hidden</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>     5 empty        empty        merge-hidden merge-hidden</span></span>
<span></span>
<span><span class="va">merge_cells</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">cell_type</span> <span class="op">==</span> <span class="st">"merge-lead"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">address</span>, <span class="va">cell_content</span>, <span class="va">merge_colspan</span>, <span class="va">merge_rowspan</span>, <span class="va">merge_shape</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 5</span></span></span>
<span><span class="co">#&gt;   address cell_content                   merge_colspan merge_rowspan merge_shape</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> A1      <span style="color: #949494;">"</span>A cell across two columns (a…             2             1 horizontal </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> A2      <span style="color: #949494;">"</span>A cell across two rows (a ve…             1             2 vertical   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> C4      <span style="color: #949494;">"</span>A cell across two columns an…             2             2 rectangular</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="style-information">Style information<a class="anchor" aria-label="anchor" href="#style-information"></a>
</h3>
<p>Style and formatting information is stored separately from cells
themselves, instead cells, rows and columns are given reference
identifiers to look up in the style information. There are four style
identifiers for each cell:</p>
<ul>
<li>
<code>cell_style</code>, style and formatting specifically applied
to that cell</li>
<li>
<code>row_style</code>, style and formatting applied to the row</li>
<li>
<code>col_style</code>, style and formatting applied to column</li>
<li>
<code>col_default_cell_style</code>, the default style and
formatting for cells in the column, i.e. when a <code>cell_style</code>
is not set</li>
</ul>
<p><strong>Note:</strong> While these style identifiers are extracted,
at present the <a href="https://github.com/mattkerlogue/tidyods" class="external-link">tidyods</a> package does not currently support
the extraction of the style and formatting rules from the ODS XML.</p>
</div>
</div>
<div class="section level2">
<h2 id="quick-extraction">Quick extraction<a class="anchor" aria-label="anchor" href="#quick-extraction"></a>
</h2>
<p>At its core an ODS file is an XML file, extracting this information
can be processor heavy. If your primary interest is just in cell
location and cell values then setting the argument
<code>quick = TRUE</code> can result in a faster extraction process as
it provides only six columns: <code>sheet</code>, <code>address</code>,
<code>row</code>, <code>col</code>, <code>value_type</code> and
<code>base_value</code>.</p>
<p>The quick extraction process varies in how the
<code>base_value</code> column is constructed. When
<code>quick = TRUE</code> only float and percentage values are taken in
their raw numeric form, for all other types the
<code>cell_content</code> is used. That means that for currency, date
and time value types the value as formatted for spreadsheet application
users is returned rather than the “raw” value stored in the underlying
XML file.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/read_ods_cells.html">read_ods_cells</a></span><span class="op">(</span><span class="va">example_file</span>, <span class="fl">2</span>, quick <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">row</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 6</span></span></span>
<span><span class="co">#&gt;    sheet address   row   col value_type base_value       </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> types A3          3     1 string     Cell with comment</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> types B3          3     2 boolean    FALSE            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> types C3          3     3 currency   £1.20            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> types D3          3     4 date       06/15/22         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> types E3          3     5 time       13:24            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> types F3          3     6 date       15/06/22 13:24   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> types G3          3     7 float      12034.56789      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> types H3          3     8 percentage 0.5467           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> types I3          3     9 float      6579.298265463   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> types J3          3    10 string     #DIV/0!</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="value-types-examples">Value types examples<a class="anchor" aria-label="anchor" href="#value-types-examples"></a>
</h2>
<div class="section level3">
<h3 id="boolean">Boolean<a class="anchor" aria-label="anchor" href="#boolean"></a>
</h3>
<p>Boolean values (<code>TRUE</code>/<code>FALSE</code>) are equivalent
to R’s <code><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical()</a></code> data type.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">types_cells</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">value_type</span> <span class="op">==</span> <span class="st">"boolean"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">cell_content</span>, <span class="va">base_value</span>, <span class="va">boolean_value</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 14 × 3</span></span></span>
<span><span class="co">#&gt;    cell_content base_value boolean_value</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> TRUE         true       TRUE         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> FALSE        false      FALSE        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> TRUE         true       TRUE         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> TRUE         true       TRUE         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> FALSE        false      FALSE        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> FALSE        false      FALSE        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> TRUE         true       TRUE         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> FALSE        false      FALSE        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> FALSE        false      FALSE        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> TRUE         true       TRUE         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> FALSE        false      FALSE        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> TRUE         true       TRUE         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> TRUE         true       TRUE         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> TRUE         true       TRUE</span></span></code></pre></div>
<p><strong>Note:</strong> ODS files produced by Google Sheets output
boolean values differently from other applications. Google Sheets stores
booleans as <code>float</code> values of <code>0</code> for
<code>FALSE</code> and <code>1</code> for <code>TRUE</code>, and gives
the cells a formula of <code>=FALSE()</code> and <code>=TRUE()</code>
instead. <code><a href="../reference/read_ods_cells.html">read_ods_cells()</a></code> will output the value type,
numeric value and formula written by Google Sheets, however it uses the
formula references to input the relevant
<code>TRUE</code>/<code>FALSE</code> value to the
<code>boolean_value</code> column.</p>
</div>
<div class="section level3">
<h3 id="currency">Currency<a class="anchor" aria-label="anchor" href="#currency"></a>
</h3>
<p>Currency values are numeric values with a
<code>currency_symbol</code>, the specific formatting of the currency
symbol is handled by style formatting rules</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">types_cells</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">value_type</span> <span class="op">==</span> <span class="st">"currency"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">cell_content</span>, <span class="va">base_value</span>, <span class="va">numeric_value</span>, <span class="va">currency_symbol</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 14 × 4</span></span></span>
<span><span class="co">#&gt;    cell_content base_value numeric_value currency_symbol</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> £1.20        1.2                  1.2 GBP            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> £1.20        1.2                  1.2 GBP            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> £1.20        1.2                  1.2 GBP            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> £1.20        1.2                  1.2 GBP            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 1.20 €       1.2                  1.2 EUR            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 1.20 €       1.2                  1.2 EUR            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> €1.20        1.2                  1.2 EUR            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> $1.20        1.2                  1.2 CAD            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> $1.20        1.2                  1.2 USD            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 1.20 USD     1.2                  1.2 USD            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> £1.20        1.2                  1.2 GBP            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> £1.20        1.2                  1.2 GBP            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> £1.20        1.2                  1.2 GBP            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> £1.20        1.2                  1.2 GBP</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="date">Date<a class="anchor" aria-label="anchor" href="#date"></a>
</h3>
<p>The ODS specification does not differentiate between a date
(e.g. 15/06/2022) and a date-time (e.g. 15/06/2023 13:47). The
<code>cell_content</code> column will show the date as formatted for
spreadsheet users, e.g. <code>Wednesday, 15 June 2022</code> or
<code>15/06/22</code>. The <code>date_value</code> (and thus
<code>base_value</code>) is stored in ISO 8601 format
(<code>0000-00-00T00:00:00</code>).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">types_cells</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">value_type</span> <span class="op">==</span> <span class="st">"date"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">cell_content</span>, <span class="va">base_value</span>, <span class="va">date_value</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 28 × 3</span></span></span>
<span><span class="co">#&gt;    cell_content                    base_value          date_value         </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 15/06/22                        2022-06-15          2022-06-15         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 15/06/2022 13:24:56             2022-06-15T13:24:56 2022-06-15T13:24:56</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 06/15/22                        2022-06-15          2022-06-15         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 15/06/22 13:24                  2022-06-15T13:24:56 2022-06-15T13:24:56</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Wed 15 Jun 22                   2022-06-15          2022-06-15         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 15-Jun-22 13:24                 2022-06-15T13:24:56 2022-06-15T13:24:56</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Wednesday 15 June 2022          2022-06-15          2022-06-15         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Wednesday 15 June 2022 01:24 PM 2022-06-15T13:24:56 2022-06-15T13:24:56</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 15-Jun-22                       2022-06-15          2022-06-15         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 15/06 13.24                     2022-06-15T13:24:56 2022-06-15T13:24:56</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 18 more rows</span></span></span></code></pre></div>
<p>As the date value type can contain both date and date-time values the
<code>date_value</code> column is not coerced by
<code><a href="../reference/read_ods_cells.html">read_ods_cells()</a></code> into a base R data type. While you can use
base R’s <code><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date()</a></code> to coerce to a date, if processing
date-times you need to replace the <code>T</code> marker stored in
<code>date_value</code> with a space in order for
<code><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct()</a></code> to coerce date-times correctly. Alternatively,
you can use <code><a href="https://lubridate.tidyverse.org/reference/as_date.html" class="external-link">lubridate::as_datetime()</a></code> without modifying the
<code>date_value</code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">types_cells</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">value_type</span> <span class="op">==</span> <span class="st">"date"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">cell_content</span>, <span class="va">date_value</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"T"</span>, <span class="va">date_value</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>date_value2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">date_value</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 14 × 3</span></span></span>
<span><span class="co">#&gt;    cell_content           date_value date_value2</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 15/06/22               2022-06-15 2022-06-15 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 06/15/22               2022-06-15 2022-06-15 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Wed 15 Jun 22          2022-06-15 2022-06-15 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Wednesday 15 June 2022 2022-06-15 2022-06-15 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 15-Jun-22              2022-06-15 2022-06-15 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 15/06/2022             2022-06-15 2022-06-15 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 15. Jun. 2022          2022-06-15 2022-06-15 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 15 Jun 22              2022-06-15 2022-06-15 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> mer. 15 juin 22        2022-06-15 2022-06-15 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2022-06-15             2022-06-15 2022-06-15 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> 15/06/22               2022-06-15 2022-06-15 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> 15/06/22               2022-06-15 2022-06-15 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> 15/06/22               2022-06-15 2022-06-15 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> 15/06/22               2022-06-15 2022-06-15</span></span>
<span></span>
<span><span class="va">types_cells</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">value_type</span> <span class="op">==</span> <span class="st">"date"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">cell_content</span>, <span class="va">date_value</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"T"</span>, <span class="va">date_value</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co"># dplyr::mutate(date_value2 = as.POSIXct(gsub("T", " ", y)))</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>date_value2 <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/as_date.html" class="external-link">as_datetime</a></span><span class="op">(</span><span class="va">date_value</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 14 × 3</span></span></span>
<span><span class="co">#&gt;    cell_content                    date_value          date_value2        </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 15/06/2022 13:24:56             2022-06-15T13:24:56 2022-06-15 <span style="color: #949494;">13:24:56</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 15/06/22 13:24                  2022-06-15T13:24:56 2022-06-15 <span style="color: #949494;">13:24:56</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 15-Jun-22 13:24                 2022-06-15T13:24:56 2022-06-15 <span style="color: #949494;">13:24:56</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Wednesday 15 June 2022 01:24 PM 2022-06-15T13:24:56 2022-06-15 <span style="color: #949494;">13:24:56</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 15/06 13.24                     2022-06-15T13:24:56 2022-06-15 <span style="color: #949494;">13:24:56</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2022-06-15 13:24:56             2022-06-15T13:24:56 2022-06-15 <span style="color: #949494;">13:24:56</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 20220615-132456                 2022-06-15T13:24:56 2022-06-15 <span style="color: #949494;">13:24:56</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 15-Jun 1:24 PM                  2022-06-15T13:24:56 2022-06-15 <span style="color: #949494;">13:24:56</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 15 juin 2022 13:24              2022-06-15T13:24:56 2022-06-15 <span style="color: #949494;">13:24:56</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 06/15/22 13-24                  2022-06-15T13:24:56 2022-06-15 <span style="color: #949494;">13:24:56</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> 15/06/2022 13:24:56             2022-06-15T13:24:56 2022-06-15 <span style="color: #949494;">13:24:56</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> 15/06/2022 13:24:56             2022-06-15T13:24:56 2022-06-15 <span style="color: #949494;">13:24:56</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> 15/06/2022 13:24:56             2022-06-15T13:24:56 2022-06-15 <span style="color: #949494;">13:24:56</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> 15/06/2022 13:24:56             2022-06-15T13:24:56 2022-06-15 <span style="color: #949494;">13:24:56</span></span></span></code></pre></div>
<p>The <a href="https://www.w3.org/TR/2004/REC-xmlschema-2-20041028/#isoformats" class="external-link">W3C
XML schema</a> has more details on the specifics of ISO formatting of
dates and date-times.</p>
<p><strong>Note:</strong> ODS files produced by Microsoft Excel output
all dates as date-times with the time component of the date set to
<code>00:00:00</code>, this is a further reason for
<code><a href="../reference/read_ods_cells.html">read_ods_cells()</a></code> not automatically coercing
<code>date_value</code> to an R data type.</p>
</div>
<div class="section level3">
<h3 id="float">Float<a class="anchor" aria-label="anchor" href="#float"></a>
</h3>
<p>Numeric values, with the exception of currency and percentage types,
are defined as a <code>float</code> value type.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">types_cells</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">value_type</span> <span class="op">==</span> <span class="st">"float"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">cell_content</span>, <span class="va">base_value</span>, <span class="va">numeric_value</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 37 × 3</span></span></span>
<span><span class="co">#&gt;    cell_content base_value     numeric_value</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 12035        12034.56789     <span style="text-decoration: underline;">12</span>034.567<span style="text-decoration: underline;">89</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 0.5467       0.5467              0.546<span style="text-decoration: underline;">7</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 6579.3       6579.298265463   <span style="text-decoration: underline;">6</span>579.298<span style="text-decoration: underline;">265</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 12034.57     12034.56789     <span style="text-decoration: underline;">12</span>034.567<span style="text-decoration: underline;">89</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 6579.3       6579.298265463   <span style="text-decoration: underline;">6</span>579.298<span style="text-decoration: underline;">265</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 12034.5679   12034.56789     <span style="text-decoration: underline;">12</span>034.567<span style="text-decoration: underline;">89</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 6579.3       6579.298265463   <span style="text-decoration: underline;">6</span>579.298<span style="text-decoration: underline;">265</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 12034.568    12034.56789     <span style="text-decoration: underline;">12</span>034.567<span style="text-decoration: underline;">89</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 6579.3       6579.298265463   <span style="text-decoration: underline;">6</span>579.298<span style="text-decoration: underline;">265</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 12034.56789  12034.56789     <span style="text-decoration: underline;">12</span>034.567<span style="text-decoration: underline;">89</span> </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 27 more rows</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="percentage">Percentage<a class="anchor" aria-label="anchor" href="#percentage"></a>
</h3>
<p>Percentages are numeric values with formatting to include a
percentage sign. As with the currency value type the specifics of
formatting are handled by style formatting rules.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">types_cells</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">value_type</span> <span class="op">==</span> <span class="st">"percentage"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">cell_content</span>, <span class="va">base_value</span>, <span class="va">numeric_value</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 3</span></span></span>
<span><span class="co">#&gt;   cell_content base_value numeric_value</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 55%          0.5467            0.546<span style="text-decoration: underline;">7</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 54.7%        0.5467            0.546<span style="text-decoration: underline;">7</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 54.67%       0.5467            0.546<span style="text-decoration: underline;">7</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 54.670%      0.5467            0.546<span style="text-decoration: underline;">7</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 54.6700%     0.5467            0.546<span style="text-decoration: underline;">7</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="string">String<a class="anchor" aria-label="anchor" href="#string"></a>
</h3>
<p>String values are derived from the <code>cell_content</code>, the
text representation of the cell as seen by a spreadsheet application
user.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">types_cells</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">col</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="va">row</span> <span class="op">&gt;</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="va">value_type</span> <span class="op">==</span> <span class="st">"string"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">cell_content</span>, <span class="va">base_value</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 14 × 2</span></span></span>
<span><span class="co">#&gt;    cell_content                                  base_value                     </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> <span style="color: #949494;">"</span>Cell<span style="color: #949494;">"</span>                                        <span style="color: #949494;">"</span>Cell<span style="color: #949494;">"</span>                         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> <span style="color: #949494;">"</span>Cell with comment<span style="color: #949494;">"</span>                           <span style="color: #949494;">"</span>Cell with comment<span style="color: #949494;">"</span>            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> <span style="color: #949494;">"</span>Cell with\nMultiple lines<span style="color: #949494;">"</span>                   <span style="color: #949494;">"</span>Cell with\nMultiple lines<span style="color: #949494;">"</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> <span style="color: #949494;">"</span>Cell  with    repeated spaces<span style="color: #949494;">"</span>               <span style="color: #949494;">"</span>Cell  with    repeated spaces<span style="color: #949494;">"</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> <span style="color: #949494;">"</span>Cells  with    spaces\nAnd multiple   lines<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>Cells  with    spaces\nAnd mu…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> <span style="color: #949494;">"</span>Cell with formatted comment<span style="color: #949494;">"</span>                 <span style="color: #949494;">"</span>Cell with formatted comment<span style="color: #949494;">"</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> <span style="color: #949494;">"</span>Merged cell<span style="color: #949494;">"</span>                                 <span style="color: #949494;">"</span>Merged cell<span style="color: #949494;">"</span>                  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> <span style="color: #949494;">"</span>Merged cell with hidden text<span style="color: #949494;">"</span>                <span style="color: #949494;">"</span>Merged cell with hidden text<span style="color: #949494;">"</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> <span style="color: #949494;">"</span>Hidden text<span style="color: #949494;">"</span>                                 <span style="color: #949494;">"</span>Hidden text<span style="color: #949494;">"</span>                  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> <span style="color: #949494;">"</span>Cell with bold text<span style="color: #949494;">"</span>                         <span style="color: #949494;">"</span>Cell with bold text<span style="color: #949494;">"</span>          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> <span style="color: #949494;">"</span>Repeated rows<span style="color: #949494;">"</span>                               <span style="color: #949494;">"</span>Repeated rows<span style="color: #949494;">"</span>                </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> <span style="color: #949494;">"</span>Repeated rows<span style="color: #949494;">"</span>                               <span style="color: #949494;">"</span>Repeated rows<span style="color: #949494;">"</span>                </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> <span style="color: #949494;">"</span>Repeated rows<span style="color: #949494;">"</span>                               <span style="color: #949494;">"</span>Repeated rows<span style="color: #949494;">"</span>                </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> <span style="color: #949494;">"</span>une cellule dans une feuille de calcul<span style="color: #949494;">"</span>      <span style="color: #949494;">"</span>une cellule dans une feuille …</span></span></code></pre></div>
<p>While the ODS specification allows for a separate
<code>string-value</code> attribute in the XML table-cell tags, in
practice this is not implemented by the major spreadsheet
applications.</p>
</div>
<div class="section level3">
<h3 id="time">Time<a class="anchor" aria-label="anchor" href="#time"></a>
</h3>
<p>Time values are defined as a duration as specified by ISO 8601, in
the format <code>PT00H00M00S</code>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">types_cells</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">value_type</span> <span class="op">==</span> <span class="st">"time"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">cell_content</span>, <span class="va">base_value</span>, <span class="va">time_value</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 14 × 3</span></span></span>
<span><span class="co">#&gt;    cell_content base_value  time_value </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 13:24:56     PT13H24M56S PT13H24M56S</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 13:24        PT13H24M56S PT13H24M56S</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 01:24 PM     PT13H24M56S PT13H24M56S</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 1:24 PM      PT13H24M56S PT13H24M56S</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 1.24 PM      PT13H24M56S PT13H24M56S</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 13h24        PT13H24M56S PT13H24M56S</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 1324         PT13H24M56S PT13H24M56S</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 13 24        PT13H24M56S PT13H24M56S</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 13-24-56     PT13H24M56S PT13H24M56S</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 13:24:56.00  PT13H24M56S PT13H24M56S</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> 13:24:56     PT13H24M56S PT13H24M56S</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> 13:24:56     PT13H24M56S PT13H24M56S</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> 13:24:56     PT13H24M56S PT13H24M56S</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> 13:24:56     PT13H24M56S PT13H24M56S</span></span></code></pre></div>
<p>As with date values time values are not automatically coerced to an R
data type. To use base R’s <code><a href="https://rdrr.io/r/base/difftime.html" class="external-link">as.difftime()</a></code> you will need to
remove or convert the letter characters, whereas
<code><a href="https://lubridate.tidyverse.org/reference/as.duration.html" class="external-link">lubridate::as.duration()</a></code> can coerce without
modification.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">types_cells</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">value_type</span> <span class="op">==</span> <span class="st">"time"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">cell_content</span>, <span class="va">time_value</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># dplyr::mutate(</span></span>
<span>  <span class="co">#   time_value2 = as.difftime(gsub("[PTS]", "", gsub("[HM]", ":", time_value)))</span></span>
<span>  <span class="co"># )</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>time_value2 <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/as.duration.html" class="external-link">as.duration</a></span><span class="op">(</span><span class="va">time_value</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 14 × 3</span></span></span>
<span><span class="co">#&gt;    cell_content time_value  time_value2          </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;Duration&gt;</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 13:24:56     PT13H24M56S 48296s (~13.42 hours)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 13:24        PT13H24M56S 48296s (~13.42 hours)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 01:24 PM     PT13H24M56S 48296s (~13.42 hours)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 1:24 PM      PT13H24M56S 48296s (~13.42 hours)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 1.24 PM      PT13H24M56S 48296s (~13.42 hours)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 13h24        PT13H24M56S 48296s (~13.42 hours)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 1324         PT13H24M56S 48296s (~13.42 hours)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 13 24        PT13H24M56S 48296s (~13.42 hours)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 13-24-56     PT13H24M56S 48296s (~13.42 hours)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 13:24:56.00  PT13H24M56S 48296s (~13.42 hours)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> 13:24:56     PT13H24M56S 48296s (~13.42 hours)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> 13:24:56     PT13H24M56S 48296s (~13.42 hours)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> 13:24:56     PT13H24M56S 48296s (~13.42 hours)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> 13:24:56     PT13H24M56S 48296s (~13.42 hours)</span></span></code></pre></div>
<p>The <a href="https://www.w3.org/TR/2004/REC-xmlschema-2-20041028/#isoformats" class="external-link">W3C
XML schema</a> has more details on the specifics of ISO formatting of
dates and date-times.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Matt Kerlogue.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
